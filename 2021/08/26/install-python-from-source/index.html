<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>從source安裝python並記錄遇到的問題 | I'm J2hongming</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">I'm J2hongming</a><span class="subtitle">Appreciate, respect and accept it, don't take it for granted</span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a><a href="/sitemap" class="sidebar-nav-item">SiteMap</a><a href="/experience" class="sidebar-nav-item">Experience</a><a href="/bookshelf" class="sidebar-nav-item">Bookshelf</a><a href="https://www.linkedin.com/in/j2hongming/" class="sidebar-nav-item">About</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>從source安裝python並記錄遇到的問題</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2021-08-26</div><div class="post-categories"><a class="post-category-link" href="/categories/software-development/">software_development</a></div><div class="post-tags"><a class="post-tag-link" href="/tags/python/">python</a></div></div></div><article><div class="container post"><p>安裝pip和virtualenv</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">curl -o get-pip.py https://bootstrap.pypa.io/get-pip.py </span><br><span class="line">python3 get-pip.py --user</span><br><span class="line">sudo apt install virtualenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ubuntu 16.04(default python 3.5)</span></span><br><span class="line">sudo apt update</span><br><span class="line">curl -O https://bootstrap.pypa.io/pip/3.5/get-pip.py</span><br><span class="line">python3 get-pip.py --user</span><br><span class="line">sudo apt install virtualenv</span><br></pre></td></tr></table></figure>

<p>從source安裝python3.7</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install build-essential zlib1g-dev libncurses5-dev libgdbm-dev libnss3-dev libssl-dev libreadline-dev libffi-dev wget</span><br><span class="line">ver=3.7.10</span><br><span class="line">ver_under_score=$(<span class="built_in">echo</span> <span class="variable">$ver</span> | sed -e <span class="string">'s/\./_/g'</span>)</span><br><span class="line">tmp_build_dir=/tmp/<span class="variable">$&#123;ver_under_score&#125;</span></span><br><span class="line">mkdir <span class="variable">$&#123;tmp_build_dir&#125;</span> &amp;&amp; <span class="built_in">cd</span> <span class="variable">$&#123;tmp_build_dir&#125;</span></span><br><span class="line">wget https://www.python.org/ftp/python/<span class="variable">$&#123;ver&#125;</span>/Python-<span class="variable">$&#123;ver&#125;</span>.tar.xz</span><br><span class="line">tar xvf Python-<span class="variable">$&#123;ver&#125;</span>.tar.xz -C <span class="variable">$&#123;tmp_build_dir&#125;</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$&#123;tmp_build_dir&#125;</span>/Python-<span class="variable">$&#123;ver&#125;</span>/</span><br><span class="line">./configure --<span class="built_in">enable</span>-optimizations</span><br><span class="line">sudo make altinstall</span><br></pre></td></tr></table></figure>

<p>將原本的python3換成python3.7</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 -V</span><br><span class="line">update-alternatives --install /usr/bin/python3 python3 /usr/<span class="built_in">local</span>/bin/python3.7 1</span><br><span class="line">python3 -V</span><br></pre></td></tr></table></figure>

<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><ul>
<li><a href="https://docs.python.org/3/using/unix.html" target="_blank" rel="noopener">Using Python on Unix platforms</a></li>
<li><a href="https://medium.com/k2shouai/ubuntu-16-04-%E6%9B%B4%E6%96%B0-python-3-7-f08cee97a64b" target="_blank" rel="noopener">Ubuntu 16.04 更新 Python 3.7</a></li>
<li><a href="https://stackoverflow.com/questions/45542690/how-to-set-python3-5-2-as-default-python-version-on-centos" target="_blank" rel="noopener">How to set Python3.5.2 as default Python version on CentOS</a></li>
<li><a href="https://stackoverflow.com/questions/44967202/pip-is-showing-error-lsb-release-a-returned-non-zero-exit-status-1" target="_blank" rel="noopener">pip is showing error ‘lsb_release -a’ returned non-zero exit status 1</a></li>
</ul>
<h2 id="zlib1g-dev相依問題"><a href="#zlib1g-dev相依問題" class="headerlink" title="zlib1g-dev相依問題"></a>zlib1g-dev相依問題</h2><p>出現linux-headers相依性問題, 看起來是linux-headers-4.4.0-169-generic尚未被安裝, 使用<code>uname -r</code> 確認目前版本並透過<code>ls -la /usr/src/</code>確認已下載的檔案, 最後利用系統提示的<code>sudo apt-get -f install</code>重新安裝linux-headers</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install -y zlib1g-dev</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree</span><br><span class="line">Reading state information... Done</span><br><span class="line">You might want to run &apos;apt-get -f install&apos; to correct these:</span><br><span class="line">The following packages have unmet dependencies:</span><br><span class="line"> linux-headers-generic : Depends: linux-headers-4.4.0-169-generic but it is not going to be installed</span><br><span class="line"> zlib1g-dev : Depends: zlib1g (= 1:1.2.8.dfsg-2ubuntu4.3) but 1:1.2.8.dfsg-2ubuntu4 is to be installed</span><br><span class="line"></span><br><span class="line">$ uname -r</span><br><span class="line">4.4.0-166-generic</span><br><span class="line"></span><br><span class="line">$ ls -la /usr/src/</span><br><span class="line">total 132</span><br><span class="line">drwxr-xr-x 33 root root 4096 Nov 13  2019 .</span><br><span class="line">drwxr-xr-x 10 root root 4096 Feb 21  2017 ..</span><br><span class="line">drwxr-xr-x 27 root root 4096 Dec 10  2018 linux-headers-4.4.0-140</span><br><span class="line">drwxr-xr-x  7 root root 4096 Dec 10  2018 linux-headers-4.4.0-140-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Dec 21  2018 linux-headers-4.4.0-141</span><br><span class="line">drwxr-xr-x  7 root root 4096 Dec 21  2018 linux-headers-4.4.0-141-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Feb  4  2019 linux-headers-4.4.0-142</span><br><span class="line">drwxr-xr-x  7 root root 4096 Feb  4  2019 linux-headers-4.4.0-142-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Mar 15  2019 linux-headers-4.4.0-143</span><br><span class="line">drwxr-xr-x  7 root root 4096 Mar 15  2019 linux-headers-4.4.0-143-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Apr  3  2019 linux-headers-4.4.0-145</span><br><span class="line">drwxr-xr-x  7 root root 4096 Apr  3  2019 linux-headers-4.4.0-145-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 May 16  2019 linux-headers-4.4.0-148</span><br><span class="line">drwxr-xr-x  7 root root 4096 May 16  2019 linux-headers-4.4.0-148-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Jun  6  2019 linux-headers-4.4.0-150</span><br><span class="line">drwxr-xr-x  7 root root 4096 Jun  6  2019 linux-headers-4.4.0-150-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Jun 20  2019 linux-headers-4.4.0-151</span><br><span class="line">drwxr-xr-x  7 root root 4096 Jun 20  2019 linux-headers-4.4.0-151-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Jun 29  2019 linux-headers-4.4.0-154</span><br><span class="line">drwxr-xr-x  7 root root 4096 Jun 29  2019 linux-headers-4.4.0-154-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Jul 25  2019 linux-headers-4.4.0-157</span><br><span class="line">drwxr-xr-x  7 root root 4096 Jul 25  2019 linux-headers-4.4.0-157-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Aug 14  2019 linux-headers-4.4.0-159</span><br><span class="line">drwxr-xr-x  7 root root 4096 Aug 14  2019 linux-headers-4.4.0-159-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Sep  4  2019 linux-headers-4.4.0-161</span><br><span class="line">drwxr-xr-x  7 root root 4096 Sep  4  2019 linux-headers-4.4.0-161-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Sep 18  2019 linux-headers-4.4.0-164</span><br><span class="line">drwxr-xr-x  7 root root 4096 Sep 18  2019 linux-headers-4.4.0-164-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Oct  2  2019 linux-headers-4.4.0-165</span><br><span class="line">drwxr-xr-x  7 root root 4096 Oct  2  2019 linux-headers-4.4.0-165-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Oct 22  2019 linux-headers-4.4.0-166</span><br><span class="line">drwxr-xr-x  7 root root 4096 Oct 22  2019 linux-headers-4.4.0-166-generic</span><br><span class="line">drwxr-xr-x 27 root root 4096 Nov 13  2019 linux-headers-4.4.0-169</span><br></pre></td></tr></table></figure>

<blockquote>
<p>sudo apt-get -f install</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get -f install</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree</span><br><span class="line">Reading state information... Done</span><br><span class="line">Correcting dependencies... Done</span><br><span class="line">The following packages were automatically installed and are no longer required:</span><br><span class="line">  linux-headers-4.4.0-140 linux-headers-4.4.0-140-generic linux-headers-4.4.0-141 linux-headers-4.4.0-141-generic linux-headers-4.4.0-142 linux-headers-4.4.0-142-generic</span><br><span class="line">  linux-headers-4.4.0-143 linux-headers-4.4.0-143-generic linux-headers-4.4.0-145 linux-headers-4.4.0-145-generic linux-headers-4.4.0-148 linux-headers-4.4.0-148-generic</span><br><span class="line">  linux-headers-4.4.0-150 linux-headers-4.4.0-150-generic linux-headers-4.4.0-151 linux-headers-4.4.0-151-generic linux-headers-4.4.0-154 linux-headers-4.4.0-154-generic</span><br><span class="line">  linux-headers-4.4.0-157 linux-headers-4.4.0-157-generic linux-headers-4.4.0-159 linux-headers-4.4.0-159-generic linux-headers-4.4.0-161 linux-headers-4.4.0-161-generic</span><br><span class="line">  linux-headers-4.4.0-164 linux-headers-4.4.0-164-generic linux-headers-4.4.0-169 linux-headers-4.4.0-64 linux-headers-4.4.0-64-generic linux-headers-4.4.0-66</span><br><span class="line">  linux-headers-4.4.0-66-generic linux-headers-4.4.0-70 linux-headers-4.4.0-70-generic linux-headers-4.4.0-71 linux-headers-4.4.0-71-generic linux-headers-4.4.0-72</span><br><span class="line">  linux-headers-4.4.0-72-generic linux-headers-4.4.0-75 linux-headers-4.4.0-75-generic linux-headers-4.4.0-78 linux-headers-4.4.0-78-generic linux-headers-4.4.0-79</span><br><span class="line">  linux-headers-4.4.0-79-generic linux-headers-4.4.0-81 linux-headers-4.4.0-81-generic linux-headers-4.4.0-83 linux-headers-4.4.0-83-generic linux-headers-4.4.0-87</span><br><span class="line">  linux-headers-4.4.0-87-generic linux-headers-4.4.0-89 linux-headers-4.4.0-89-generic linux-headers-4.4.0-91 linux-headers-4.4.0-91-generic linux-headers-4.4.0-92</span><br><span class="line">  linux-headers-4.4.0-92-generic linux-headers-4.4.0-93 linux-headers-4.4.0-93-generic linux-headers-4.4.0-97 linux-image-4.4.0-140-generic linux-image-4.4.0-141-generic</span><br><span class="line">  linux-image-4.4.0-142-generic linux-image-4.4.0-143-generic linux-image-4.4.0-145-generic linux-image-4.4.0-148-generic linux-image-4.4.0-150-generic</span><br><span class="line">  linux-image-4.4.0-151-generic linux-image-4.4.0-154-generic linux-image-4.4.0-157-generic linux-image-4.4.0-159-generic linux-image-4.4.0-161-generic</span><br><span class="line">  linux-image-4.4.0-164-generic linux-image-4.4.0-169-generic linux-image-4.4.0-64-generic linux-image-4.4.0-66-generic linux-image-4.4.0-70-generic linux-image-4.4.0-71-generic</span><br><span class="line">  linux-image-4.4.0-72-generic linux-image-4.4.0-75-generic linux-image-4.4.0-78-generic linux-image-4.4.0-79-generic linux-image-4.4.0-81-generic linux-image-4.4.0-83-generic</span><br><span class="line">  linux-image-4.4.0-87-generic linux-image-4.4.0-89-generic linux-image-4.4.0-91-generic linux-image-4.4.0-92-generic linux-image-4.4.0-93-generic linux-modules-4.4.0-143-generic</span><br><span class="line">  linux-modules-4.4.0-145-generic linux-modules-4.4.0-148-generic linux-modules-4.4.0-150-generic linux-modules-4.4.0-151-generic linux-modules-4.4.0-154-generic</span><br><span class="line">  linux-modules-4.4.0-157-generic linux-modules-4.4.0-159-generic linux-modules-4.4.0-161-generic linux-modules-4.4.0-164-generic linux-modules-4.4.0-169-generic</span><br><span class="line">Use &apos;sudo apt autoremove&apos; to remove them.</span><br><span class="line">The following additional packages will be installed:</span><br><span class="line">  linux-headers-4.4.0-210 linux-headers-4.4.0-210-generic linux-headers-generic linux-headers-virtual linux-image-4.4.0-210-generic linux-image-virtual</span><br><span class="line">  linux-modules-4.4.0-210-generic linux-virtual</span><br><span class="line">Suggested packages:</span><br><span class="line">  fdutils linux-doc-4.4.0 | linux-source-4.4.0 linux-tools</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  linux-headers-4.4.0-210 linux-headers-4.4.0-210-generic linux-image-4.4.0-210-generic linux-modules-4.4.0-210-generic</span><br><span class="line">The following packages will be upgraded:</span><br><span class="line">  linux-headers-generic linux-headers-virtual linux-image-virtual linux-virtual</span><br><span class="line">4 upgraded, 4 newly installed, 0 to remove and 243 not upgraded.</span><br><span class="line">9 not fully installed or removed.</span><br><span class="line">Need to get 29.8 MB of archives.</span><br><span class="line">After this operation, 147 MB of additional disk space will be used.</span><br><span class="line">Do you want to continue? [Y/n] Y</span><br><span class="line">Get:1 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-modules-4.4.0-210-generic amd64 4.4.0-210.242 [12.1 MB]</span><br><span class="line">Get:2 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.4.0-210-generic amd64 4.4.0-210.242 [6,954 kB]</span><br><span class="line">Get:3 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-virtual amd64 4.4.0.210.216 [1,780 B]</span><br><span class="line">Get:4 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-virtual amd64 4.4.0.210.216 [2,462 B]</span><br><span class="line">Get:5 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-headers-virtual amd64 4.4.0.210.216 [1,754 B]</span><br><span class="line">Get:6 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-headers-4.4.0-210 all 4.4.0-210.242 [10.0 MB]</span><br><span class="line">Get:7 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-headers-4.4.0-210-generic amd64 4.4.0-210.242 [786 kB]</span><br><span class="line">Get:8 http://us-east-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-headers-generic amd64 4.4.0.210.216 [2,290 B]</span><br><span class="line">Fetched 29.8 MB in 0s (47.9 MB/s)</span><br><span class="line">Selecting previously unselected package linux-modules-4.4.0-210-generic.</span><br><span class="line">(Reading database ... 937136 files and directories currently installed.)</span><br><span class="line">Preparing to unpack .../linux-modules-4.4.0-210-generic_4.4.0-210.242_amd64.deb ...</span><br><span class="line">Unpacking linux-modules-4.4.0-210-generic (4.4.0-210.242) ...</span><br><span class="line">Selecting previously unselected package linux-image-4.4.0-210-generic.</span><br><span class="line">Preparing to unpack .../linux-image-4.4.0-210-generic_4.4.0-210.242_amd64.deb ...</span><br><span class="line">Unpacking linux-image-4.4.0-210-generic (4.4.0-210.242) ...</span><br><span class="line">Preparing to unpack .../linux-virtual_4.4.0.210.216_amd64.deb ...</span><br><span class="line">Unpacking linux-virtual (4.4.0.210.216) over (4.4.0.169.177) ...</span><br><span class="line">Preparing to unpack .../linux-image-virtual_4.4.0.210.216_amd64.deb ...</span><br><span class="line">Unpacking linux-image-virtual (4.4.0.210.216) over (4.4.0.169.177) ...</span><br><span class="line">Preparing to unpack .../linux-headers-virtual_4.4.0.210.216_amd64.deb ...</span><br><span class="line">Unpacking linux-headers-virtual (4.4.0.210.216) over (4.4.0.169.177) ...</span><br><span class="line">Selecting previously unselected package linux-headers-4.4.0-210.</span><br><span class="line">Preparing to unpack .../linux-headers-4.4.0-210_4.4.0-210.242_all.deb ...</span><br><span class="line">Unpacking linux-headers-4.4.0-210 (4.4.0-210.242) ...</span><br><span class="line">Selecting previously unselected package linux-headers-4.4.0-210-generic.</span><br><span class="line">Preparing to unpack .../linux-headers-4.4.0-210-generic_4.4.0-210.242_amd64.deb ...</span><br><span class="line">Unpacking linux-headers-4.4.0-210-generic (4.4.0-210.242) ...</span><br><span class="line">Preparing to unpack .../linux-headers-generic_4.4.0.210.216_amd64.deb ...</span><br><span class="line">Unpacking linux-headers-generic (4.4.0.210.216) over (4.4.0.169.177) ...</span><br><span class="line">Setting up libjpeg-turbo8:amd64 (1.4.2-0ubuntu3.3) ...</span><br><span class="line">Setting up linux-headers-4.4.0-169 (4.4.0-169.198) ...</span><br><span class="line">Setting up linux-modules-4.4.0-210-generic (4.4.0-210.242) ...</span><br><span class="line">Setting up linux-image-4.4.0-210-generic (4.4.0-210.242) ...</span><br><span class="line">I: /vmlinuz.old is now a symlink to boot/vmlinuz-4.4.0-166-generic</span><br><span class="line">I: /initrd.img.old is now a symlink to boot/initrd.img-4.4.0-166-generic</span><br><span class="line">I: /vmlinuz is now a symlink to boot/vmlinuz-4.4.0-210-generic</span><br><span class="line">I: /initrd.img is now a symlink to boot/initrd.img-4.4.0-210-generic</span><br><span class="line">Setting up linux-image-virtual (4.4.0.210.216) ...</span><br><span class="line">Setting up linux-headers-4.4.0-210 (4.4.0-210.242) ...</span><br><span class="line">Setting up linux-headers-4.4.0-210-generic (4.4.0-210.242) ...</span><br><span class="line">Setting up linux-headers-generic (4.4.0.210.216) ...</span><br><span class="line">Setting up linux-headers-virtual (4.4.0.210.216) ...</span><br><span class="line">Setting up linux-virtual (4.4.0.210.216) ...</span><br><span class="line">Setting up linux-modules-4.4.0-169-generic (4.4.0-169.198) ...</span><br><span class="line">Setting up linux-image-4.4.0-169-generic (4.4.0-169.198) ...</span><br><span class="line">I: /vmlinuz.old is now a symlink to boot/vmlinuz-4.4.0-210-generic</span><br><span class="line">I: /vmlinuz is now a symlink to boot/vmlinuz-4.4.0-169-generic</span><br><span class="line">I: /initrd.img is now a symlink to boot/initrd.img-4.4.0-169-generic</span><br><span class="line">Setting up linux-libc-dev:amd64 (4.4.0-169.198) ...</span><br><span class="line">Processing triggers for libc-bin (2.23-0ubuntu10) ...</span><br><span class="line">Processing triggers for linux-image-4.4.0-210-generic (4.4.0-210.242) ...</span><br><span class="line">/etc/kernel/postinst.d/initramfs-tools:</span><br><span class="line">update-initramfs: Generating /boot/initrd.img-4.4.0-210-generic</span><br><span class="line">W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.</span><br><span class="line">/etc/kernel/postinst.d/zz-update-grub:</span><br><span class="line">Generating grub configuration file ...</span><br><span class="line">Found linux image: /boot/vmlinuz-4.4.0-210-generic</span><br><span class="line">...</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h3 id="參考-1"><a href="#參考-1" class="headerlink" title="參考"></a>參考</h3><ul>
<li><a href="https://askubuntu.com/questions/1079624/apt-get-install-fails-to-create-dependency-tree-every-time" target="_blank" rel="noopener">apt-get install fails to create dependency tree every time</a></li>
</ul>
<h2 id="執行sudo-apt-get-install-f-發生錯誤"><a href="#執行sudo-apt-get-install-f-發生錯誤" class="headerlink" title="執行sudo apt-get install -f 發生錯誤"></a>執行sudo apt-get install -f 發生錯誤</h2><p>錯誤訊息訊息看起來是disk空間滿了, 但使用<code>df -sh</code>發現還有空間, 後來查了一篇文章所提示的線索可能是inode滿了, 透過<code>df -i</code>檢查的確已經100%, 最後透過手動刪除<code>/usr/src/</code>較舊的linux-header減少inode的使用量</p>
<blockquote>
<p>No apport report written because the error message indicates a disk full error</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -f install</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree</span><br><span class="line">Reading state information... Done</span><br><span class="line">Correcting dependencies... Done</span><br><span class="line">The following packages were automatically installed and are no longer required:</span><br><span class="line">  linux-headers-4.4.0-154 linux-headers-4.4.0-154-generic linux-headers-4.4.0-64 linux-headers-4.4.0-64-generic linux-headers-4.4.0-66 linux-headers-4.4.0-66-generic</span><br><span class="line">  linux-headers-4.4.0-70 linux-headers-4.4.0-70-generic linux-headers-4.4.0-71 linux-headers-4.4.0-71-generic linux-headers-4.4.0-72 linux-headers-4.4.0-72-generic</span><br><span class="line">  linux-headers-4.4.0-75 linux-headers-4.4.0-75-generic linux-headers-4.4.0-78 linux-headers-4.4.0-78-generic linux-headers-4.4.0-79 linux-headers-4.4.0-79-generic</span><br><span class="line">  linux-headers-4.4.0-81 linux-headers-4.4.0-81-generic linux-headers-4.4.0-83 linux-headers-4.4.0-83-generic linux-headers-4.4.0-87 linux-headers-4.4.0-87-generic</span><br><span class="line">  linux-headers-4.4.0-89 linux-headers-4.4.0-89-generic linux-headers-4.4.0-91 linux-headers-4.4.0-91-generic linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic</span><br><span class="line">  linux-headers-4.4.0-93 linux-headers-4.4.0-93-generic linux-headers-4.4.0-97 linux-image-4.4.0-154-generic linux-image-4.4.0-64-generic linux-image-4.4.0-66-generic</span><br><span class="line">  linux-image-4.4.0-70-generic linux-image-4.4.0-71-generic linux-image-4.4.0-72-generic linux-image-4.4.0-75-generic linux-image-4.4.0-78-generic linux-image-4.4.0-79-generic</span><br><span class="line">  linux-image-4.4.0-81-generic linux-image-4.4.0-83-generic linux-image-4.4.0-87-generic linux-image-4.4.0-89-generic linux-image-4.4.0-91-generic linux-image-4.4.0-92-generic</span><br><span class="line">  linux-image-4.4.0-93-generic linux-modules-4.4.0-154-generic</span><br><span class="line">Use &apos;sudo apt autoremove&apos; to remove them.</span><br><span class="line">The following additional packages will be installed:</span><br><span class="line">  linux-headers-4.4.0-204-generic</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  linux-headers-4.4.0-204-generic</span><br><span class="line">0 upgraded, 1 newly installed, 0 to remove and 126 not upgraded.</span><br><span class="line">10 not fully installed or removed.</span><br><span class="line">Need to get 0 B/796 kB of archives.</span><br><span class="line">After this operation, 7,743 kB of additional disk space will be used.</span><br><span class="line">Do you want to continue? [Y/n] Y</span><br><span class="line">(Reading database ... 601175 files and directories currently installed.)</span><br><span class="line">Preparing to unpack .../linux-headers-4.4.0-204-generic_4.4.0-204.236_amd64.deb ...</span><br><span class="line">Unpacking linux-headers-4.4.0-204-generic (4.4.0-204.236) ...</span><br><span class="line">dpkg: error processing archive /var/cache/apt/archives/linux-headers-4.4.0-204-generic_4.4.0-204.236_amd64.deb (--unpack):</span><br><span class="line"> unable to create &apos;/usr/src/linux-headers-4.4.0-204-generic/include/config/keyboard/lm8323.h.dpkg-new&apos; (while processing &apos;./usr/src/linux-headers-4.4.0-204-generic/include/config/keyboard/lm8323.h&apos;): No space left on device</span><br><span class="line">No apport report written because the error message indicates a disk full error</span><br><span class="line">                                                                              dpkg-deb: error: subprocess paste was killed by signal (Broken pipe)</span><br><span class="line">Errors were encountered while processing:</span><br><span class="line"> /var/cache/apt/archives/linux-headers-4.4.0-204-generic_4.4.0-204.236_amd64.deb</span><br><span class="line">E: Sub-process /usr/bin/dpkg returned an error code (1)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>df -i</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df -i</span><br><span class="line">Filesystem                                Inodes  IUsed  IFree IUse% Mounted on</span><br><span class="line">udev                                      495812    365 495447    1% /dev</span><br><span class="line">tmpfs                                     498134    529 497605    1% /run</span><br><span class="line">/dev/nvme0n1p1                            655360 650717   4643  100% /</span><br><span class="line">tmpfs                                     498134      1 498133    1% /dev/shm</span><br><span class="line">tmpfs                                     498134      3 498131    1% /run/lock</span><br><span class="line">tmpfs                                     498134     16 498118    1% /sys/fs/cgroup</span><br><span class="line">tmpfs                                     498134      5 498129    1% /run/user/1004</span><br></pre></td></tr></table></figure>

<h2 id="參考-2"><a href="#參考-2" class="headerlink" title="參考"></a>參考</h2><ul>
<li><a href="https://ubuntuforums.org/showthread.php?t=2039786" target="_blank" rel="noopener">apt-get “no space left on device” even it is %97 free</a></li>
<li><a href="https://stackoverflow.com/questions/653096/how-to-free-inode-usage" target="_blank" rel="noopener">How to Free Inode Usage</a></li>
</ul>
</div><!-- comment system--><div class="container"><hr><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'j2hongminggithubio';
var disqus_identifier = '2021/08/26/install-python-from-source/';
var disqus_title = '從source安裝python並記錄遇到的問題';
var disqus_url = 'http://yoursite.com/2021/08/26/install-python-from-source/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="http://twitter.com/j2hongming" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://github.com/j2hongming" target="_blank"><i class="fa fa-github"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2021 <a href="/" rel="nofollow">J2hongming</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-55818738-1');ga('send','pageview');</script></html>