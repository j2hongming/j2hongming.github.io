<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Http | J2hongming Blog]]></title>
  <link href="http://j2hongming.github.io/blog/categories/http/atom.xml" rel="self"/>
  <link href="http://j2hongming.github.io/"/>
  <updated>2016-11-07T21:36:49+08:00</updated>
  <id>http://j2hongming.github.io/</id>
  <author>
    <name><![CDATA[HongMing ChangChine]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[No Access-Control-Allow-Origin Header Is Present on the Requested Resource]]></title>
    <link href="http://j2hongming.github.io/blog/2016/04/28/no-access-control-allow-origin-header-is-present-on-the-requested-resource/"/>
    <updated>2016-04-28T11:25:22+08:00</updated>
    <id>http://j2hongming.github.io/blog/2016/04/28/no-access-control-allow-origin-header-is-present-on-the-requested-resource</id>
    <content type="html"><![CDATA[<ul>
<li>問題描述</li>
<li>本質</li>
<li>解法</li>
</ul>


<!-- more -->


<h2>問題描述</h2>

<p>使用jQuery AJAX發出Request時，console出現No &lsquo;Access-Control-Allow-Origin&rsquo; header is present on the requested resource</p>

<p>&#8220;` javascript CORS.js</p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>


<script type="text/javascript">
// ERROR, and show error message in console 
var url = "http://data.tycg.gov.tw/api/v1/rest/datastore/a1b4714b-3b75-4ff8-a8f2-cc377e4eaa0f?format=json";
// SUCCESS
var url = 'http://ptx.transportdata.tw/MOTC/v1/Bus/EstimatedTimeOfArrival/Thb?%24format=json&$top=10';

$.ajax({
   url: url,
   type: "GET",
   dataType: "JSON",
   success: function(data, textStatus, request) {
     alert("SUCCESS!!!");
     console.log(data);
   },
   error: function() {
     alert("ERROR!!!");
   }
 });

</script>


<p>&#8220;`
<div><script src='https://gist.github.com/89c858fdf4fd510fd910787a64eb9f04.js?file=CORS.js'></script>
<noscript><pre><code>&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
// ERROR, and show error message in console 
var url = &quot;http://data.tycg.gov.tw/api/v1/rest/datastore/a1b4714b-3b75-4ff8-a8f2-cc377e4eaa0f?format=json&quot;;
// SUCCESS
var url = 'http://ptx.transportdata.tw/MOTC/v1/Bus/EstimatedTimeOfArrival/Thb?%24format=json&amp;$top=10';

$.ajax({
   url: url,
   type: &quot;GET&quot;,
   dataType: &quot;JSON&quot;,
   success: function(data, textStatus, request) {
     alert(&quot;SUCCESS!!!&quot;);
     console.log(data);
   },
   error: function() {
     alert(&quot;ERROR!!!&quot;);
   }
 });

&lt;/script&gt;</code></pre></noscript></div>
</p>

<h2>本質</h2>

<p>基於同源策略(Same-origin policy)所形成的議題
根據MDN所描述，同源的定義必須<code>protocol</code>, <code>host</code>, <code>port</code>相同
所以若要取得不同網域的資源會受到限制。</p>

<h2>解法</h2>

<p>HTTP response header加上<code>Access-Control-Allow-Origin</code>屬性，若有機會碰到Server端的前提下。</p>

<p>使用JSONP溝通，Client端和Server端都要支援。</p>

<p>JQuery降版到1.4，只能動到Client端，Server端是別人家的。</p>

<h2>Ref.</h2>

<ul>
<li><a href="http://stackoverflow.com/questions/20035101/no-access-control-allow-origin-header-is-present-on-the-requested-resource">No &lsquo;Access-Control-Allow-Origin&rsquo; header is present on the requested resource</a></li>
<li><a href="https://developer.mozilla.org/zh-TW/docs/HTTP/Access_control_CORS">HTTP access control (CORS):MDN</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same-origin policy</a></li>
<li><a href="http://ithelp.ithome.com.tw/question/10094915?tab=opinion">Cross Domain Ajax 跨網域抓取資料(JSONP)</a></li>
<li><a href="http://stackoverflow.com/questions/10507345/ajax-and-jsonp-parseerror-and-uncaught-syntaxerror-unexpected-token">$.ajax and JSONP. ParseError and Uncaught SyntaxError: Unexpected token :</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
